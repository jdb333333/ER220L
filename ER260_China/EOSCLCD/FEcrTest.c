/*******************自动海量测试 *************************************
 使用ModeLock键来启动海量测试:
 1.按第一次进入海量测试并打印收据, 按第二次时海量测试不打印,
   按第三次时关闭海量测试
 2.自动海量测试需要键盘上至少定义有各种折扣和更正功能
 3. 如果要测试餐饮,那么还必须有餐饮功能
 4. 开机第一次测试时,测试完KeyEmuList中的数据后会自动停止,且不打印Z报表
 5. 继续测试时,将不会自动停止,必须人工按海量测试键来停止
*********************************************************************/
#define TESTINVMAX   6			// 每天开票张数 //
#define TESTDELAY   5  //自动销售延迟(ms)

struct  ECRTESTATTR  FisTestTask;

//---------------------------------------------
//Send a BCD data
//pPoints=Bits after point must been send
//When pPoints=2:
//1234567.896---->123456789 been send
//1234567.8------>123456780 been send
void SendABCD(BCD *pBcd);
//-----------------------------------------
//Send a long int
void SendALong(long pLInt);

#if FASTMODE
/*
    数据0:为打印Z报表
    数据1:等待过一天
    数据2~5:指定循环次数
    必须确保键盘布局中包含测试所需要的功能
*/
CONST WORD AutoKeyEmuList[]={

//>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> 超市方式下销售测试 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

// 1. 部类销售>>>>>>>>>>>>>>>>>>>

	// 每个收据三笔 //
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,	TEND+1,
//	0,// 打印Z报表 2//
	// 每个收据三笔 //
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,
	xBEFOR,'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,//更改销售
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+3,TEND+1,

    // 每个收据三笔 //
    '1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
    '1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,
    xRECEIPT,//取消销售
    '1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+3,TEND+1,

    // 每个收据三笔 //
    '1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
    '1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,
    '1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,xRECEIPT,	TEND+1,//取消交易

    //	0,// 打印Z报表 3//
//---------------------------------------------------------------------

	// 每个收据三笔,-8% //
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,'8',DISC_PERDEC,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,	TEND+1,
//	0,// 打印Z报表 4//

	// 每个收据三笔,小计折扣-8% //
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,SUB,	'8',DISC+2,TEND+1,
//	0,// 打印Z报表 6//

	// 每个收据三笔,直接折扣 //
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,'2','9','.','8','4',DISC+4,TEND+1,
//	0,// 打印Z报表 7//

	// 每个收据三笔,小计直接折扣 //
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,SUB,	'1','8','9','.','5','2',DISC+4,TEND+1,
//	0,// 打印Z报表 8//
//--------------------------------------------------------------------------

// 2. 单品销售>>>>>>>>>>>>>>>>>>>

//--------------------------------------------------------------------------

	// 每个收据三笔 //
	'1','2','3','.','0','1',NPRICE,'1','2','.','3','4','5',MULT,'1',PLU1,
	'1','2','3','.','0','2',NPRICE,'1','2','.','3','4','5',MULT,'2',PLU1,
	'1','2','3','.','0','3',NPRICE,'1','2','.','3','4','5',MULT,'3',PLU1,TEND+1,
	//0,// 打印Z报表 27//
//--------------------------------------------------------------------------

	// 每个收据三笔,-8% //
	'1','2','3','.','0','1',NPRICE,'1','2','.','3','4','5',MULT,'1',PLU1,
	'1','2','3','.','0','2',NPRICE,'1','2','.','3','4','5',MULT,'2',PLU1,
	'1','2','3','.','0','3',NPRICE,'1','2','.','3','4','5',MULT,'3',PLU1,'8',DISC+2,TEND+1,
	//0,// 打印Z报表 29//

	// 每个收据三笔,小计折扣-8% //
	'1','2','3','.','0','1',NPRICE,'1','2','.','3','4','5',MULT,'1',PLU1,
	'1','2','3','.','0','2',NPRICE,'1','2','.','3','4','5',MULT,'2',PLU1,
	'1','2','3','.','0','3',NPRICE,'1','2','.','3','4','5',MULT,'3',PLU1,SUB,'8',DISC+2,TEND+1,
	//0,// 打印Z报表 30//
//--------------------------------------------------------------------------

	// 每个收据三笔,-8 //
	'1','2','3','.','0','1',NPRICE,'1','2','.','3','4','5',MULT,'1',PLU1,
	'1','2','3','.','0','2',NPRICE,'1','2','.','3','4','5',MULT,'2',PLU1,
	'1','2','3','.','0','3',NPRICE,'1','2','.','3','4','5',MULT,'3',PLU1,'8',DISC+4,TEND+1,
	//0,// 打印Z报表 31//
//--------------------------------------------------------------------------

#if 0
#if (DEPT_TEST)
// 1. 部类销售>>>>>>>>>>>>>>>>>>>
	// 每个收据一笔 //
	'1',DEPT+1,	TEND+1,
	'2',DEPT+2,	TEND+1,
	'3',DEPT+3,	TEND+1,

	// 每个收据三笔 //
	'1',DEPT+1,
	'2',DEPT+2,
	'3',DEPT+3,	TEND+1,
#endif
#if (PLU_TEST)
// 1. 单品销售>>>>>>>>>>>>>>>>>>>
	// 每个收据一笔 //
	'1',PLU1,	TEND+1,
	'2',PLU1,	TEND+1,
	'3',PLU1,	TEND+1,
	'4',PLU1,	TEND+1,
	'5',PLU1,	TEND+1,
	'6',PLU1,	TEND+1,

	// 每个收据三笔 //
	'1',PLU1,
	'2',PLU1,
	'3',PLU1,	TEND+1,

	// 每个收据三笔 //
	'4',PLU1,
	'5',PLU1,
	'6',PLU1,	TEND+1,

#endif
#endif
    TEST_REPEAT2,
    TEST_ZREPORT,
	TEST_END
};

#else
// Test by ROM>>>>>>>>>>>>TAX1=13%,TAX2=8%,TAX3=17%>>>>>>>>>>>>>>>>>
CONST WORD KeyEmuList[]={

#if (1)

//>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> 超市方式下销售测试 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>


// 1. 部类销售>>>>>>>>>>>>>>>>>>>
	// 每个收据一笔 //
	'1','2','3','.','0','1',DEPT+1,	TEND+1, //收据01
	'1','2','3','.','0','2',DEPT+2,	TEND+1, //收据02
	'1','2','3','.','0','3',DEPT+3,	TEND+1,//收据03
//	0,// 打印Z报表 1//

	// 每个收据三笔 //
	'1','2','3','.','0','1',DEPT+1,
	'1','2','3','.','0','2',DEPT+2,
	'1','2','3','.','0','3',DEPT+3,	TEND+1,//收据04
//	0,// 打印Z报表 2//

	// 每个收据三笔 //
	'1','2','3','.','0','1',DEPT+1,
	'1','2','3','.','0','2',DEPT+2,
	'1','2','3','.','0','3',DEPT+3,
	xBEFOR,'1','2','3','.','0','1',DEPT+1,
	xBEFOR,'1','2','3','.','0','2',DEPT+2,
	'1','2','3','.','0','1',DEPT+1,
	'1','2','3','.','0','2',DEPT+2,TEND+1,//收据05
//	0,// 打印Z报表 3//
//---------------------------------------------------------------------

	// 每个收据一笔,-8% //
	'1','2','3','.','0','1',DEPT+1,'8',DISC_PERDEC,	TEND+1,//收据06
	'1','2','3','.','0','2',DEPT+2,'8',DISC_PERDEC,	TEND+1,//收据07
	'1','2','3','.','0','3',DEPT+3,'8',DISC_PERDEC,	TEND+1,//收据08
//	0,// 打印Z报表 4//

	// 每个收据三笔,-8% //
	'1','2','3','.','0','1',DEPT+1,'8',DISC_PERDEC,
	'1','2','3','.','0','2',DEPT+2,'8',DISC_PERDEC,
	'1','2','3','.','0','3',DEPT+3,	'8',DISC+2,TEND+1,//收据09
//	0,// 打印Z报表 5//

	// 每个收据三笔,小计折扣-8% //
	'1','2','3','.','0','1',DEPT+1,
	'1','2','3','.','0','2',DEPT+2,
	'1','2','3','.','0','3',DEPT+3,SUB,	'8',DISC+2,TEND+1,//收据10
//	0,// 打印Z报表 6//

	// 每个收据三笔,直接折扣 //
	'1','2','3','.','0','1',DEPT+1,'2','9','.','8','4',DISC_NETDEC,
	'1','2','3','.','0','2',DEPT+2,'2','9','.','8','4',DISC_NETDEC,
	'1','2','3','.','0','3',DEPT+3,'2','9','.','8','4',DISC_NETDEC,TEND+1,//收据11
//	0,// 打印Z报表 7//

	// 每个收据三笔,小计直接折扣 //
	'1','2','3','.','0','1',DEPT+1,
	'1','2','3','.','0','2',DEPT+2,
	'1','2','3','.','0','3',DEPT+3,SUB,	'1','8','9','.','5','2',DISC_NETDEC,TEND+1,//收据12
//	0,// 打印Z报表 8//
//--------------------------------------------------------------------------
	// 每个收据三笔,-8% //
	'1','2','3','.','0','1',DEPT+1,'8',DISC_PERDEC,
	'1','2','3','.','0','2',DEPT+2,
	'1','2','3','.','0','3',DEPT+3,'8',DISC_PERDEC,	TEND+1,//收据13
//	0,// 打印Z报表 9//
//--------------------------------------------------------------------------
	// 每个收据一笔,销售数量12.345 //

	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,	TEND+1,//收据14
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,	TEND+1,//收据15
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,	TEND+1,//收据16
//	0,// 打印Z报表 10//

	// 每个收据三笔 //
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,	TEND+1,//收据17
//	0,// 打印Z报表 11//
//--------------------------------------------------------------------------
	// 每个收据一笔,-8% //
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,'8',DISC_PERDEC,	TEND+1,//收据18
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,'8',DISC_PERDEC,	TEND+1,//收据19
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,'8',DISC_PERDEC,	TEND+1,//收据20
	//0,// 打印Z报表 12//

	// 每个收据三笔,-8% //
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,'8',DISC_PERDEC,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,'8',DISC_PERDEC,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,'8',DISC_PERDEC,	TEND+1,//收据21
	//0,// 打印Z报表 13//

	// 每个收据三笔,小计折扣-8% //
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,SUB,'8',DISC_PERDEC,	TEND+1,//收据22
	//0,// 打印Z报表 14//

	// 每个收据三笔,直接折扣 //
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,'9','0','.','8','8',DISC_NETDEC,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,'9','0','.','8','9',DISC_NETDEC,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,'9','0','.','9','0',DISC_NETDEC,	TEND+1,//收据23
	//0,// 打印Z报表 15//

	// 每个收据三笔,小计直接折扣 //
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,SUB,'2','9','.','6','7',DISC_NETDEC,	TEND+1,//收据24
	//0,// 打印Z报表 16//

//--------------------------------------------------------------------------

	// 每个收据三笔,-8% //
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,'8',DISC_PERDEC,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,'8',DISC_PERDEC,	TEND+1,//收据25
	//0,// 打印Z报表 17//
//--------------------------------------------------------------------------

// 2. 单品销售>>>>>>>>>>>>>>>>>>>
	// 每个收据一笔 //
	'1','2','3','.','0','1',NPRICE,'1',PLU1,TEND+1,//收据26
	'1','2','3','.','0','2',NPRICE,'2',PLU1,TEND+1,//收据27
	'1','2','3','.','0','3',NPRICE,'3',PLU1,	TEND+1,//收据28
	//0,// 打印Z报表 18//

	// 每个收据三笔 //
	'1','2','3','.','0','1',NPRICE,'1',PLU1,
	'1','2','3','.','0','2',NPRICE,'2',PLU1,
	'1','2','3','.','0','3',NPRICE,'3',PLU1,	TEND+1,//收据29
	//0,// 打印Z报表 19//
//--------------------------------------------------------------------------

	// 每个收据一笔,-8% //
	'1','2','3','.','0','1',NPRICE,'1',PLU1,'8',DISC_PERDEC,	TEND+1,//收据30
	'1','2','3','.','0','2',NPRICE,'2',PLU1,'8',DISC_PERDEC,	TEND+1,//收据31
	'1','2','3','.','0','3',NPRICE,'3',PLU1,'8',DISC_PERDEC,	TEND+1,//收据32
	//0,// 打印Z报表 20//


	// 每个收据三笔,-8% //
	'1','2','3','.','0','1',NPRICE,'1',PLU1,'8',DISC_PERDEC,
	'1','2','3','.','0','2',NPRICE,'2',PLU1,'8',DISC_PERDEC,
	'1','2','3','.','0','3',NPRICE,'3',PLU1,'8',DISC_PERDEC,	TEND+1,//收据33
	//0,// 打印Z报表 21//

	// 每个收据三笔,小计折扣-8% //
	'1','2','3','.','0','1',NPRICE,'1',PLU1,
	'1','2','3','.','0','2',NPRICE,'2',PLU1,
	'1','2','3','.','0','3',NPRICE,'3',PLU1,SUB,'8',DISC_PERDEC,	TEND+1,//收据34
	//0,// 打印Z报表 22//

	// 每个收据三笔,直接折扣 //
	'1','2','3','.','0','1',NPRICE,'1',PLU1,'2','9','.','8','4',DISC_NETDEC,
	'1','2','3','.','0','2',NPRICE,'2',PLU1,'2','9','.','8','4',DISC_NETDEC,
	'1','2','3','.','0','3',NPRICE,'3',PLU1,'2','9','.','8','4',DISC_NETDEC,	TEND+1,//收据35
	//0,// 打印Z报表 23//

	// 每个收据三笔,小计直接折扣 //
	'1','2','3','.','0','1',NPRICE,'1',PLU1,
	'1','2','3','.','0','2',NPRICE,'2',PLU1,
	'1','2','3','.','0','3',NPRICE,'3',PLU1,SUB,'8','9','.','5','2',DISC_NETDEC,	TEND+1,//收据36
	//0,// 打印Z报表 24//
//--------------------------------------------------------------------------

	// 每个收据三笔,-8% //
	'1','2','3','.','0','1',NPRICE,'1',PLU1,'8',DISC_PERDEC,
	'1','2','3','.','0','2',NPRICE,'2',PLU1,
	'1','2','3','.','0','3',NPRICE,'3',PLU1,'8',DISC_PERDEC,	TEND+1,//收据37
	//0,// 打印Z报表 25//

//--------------------------------------------------------------------------

	// 每个收据一笔,销售数量12.345 //
	'1','2','3','.','0','1',NPRICE,'1','2','.','3','4','5',MULT,'1',PLU1,TEND+1,//收据38
	'1','2','3','.','0','2',NPRICE,'1','2','.','3','4','5',MULT,'2',PLU1,TEND+1,//收据39
	'1','2','3','.','0','3',NPRICE,'1','2','.','3','4','5',MULT,'3',PLU1,TEND+1,//收据40
	//0,// 打印Z报表 26//

	// 每个收据三笔 //
	'1','2','3','.','0','1',NPRICE,'1','2','.','3','4','5',MULT,'1',PLU1,
	'1','2','3','.','0','2',NPRICE,'1','2','.','3','4','5',MULT,'2',PLU1,
	'1','2','3','.','0','3',NPRICE,'1','2','.','3','4','5',MULT,'3',PLU1,TEND+1,//收据41
	//0,// 打印Z报表 27//
//--------------------------------------------------------------------------

	// 每个收据一笔,-8% //
	'1','2','3','.','0','1',NPRICE,'1','2','.','3','4','5',MULT,'1',PLU1,'8',DISC+2,TEND+1,//收据42
	'1','2','3','.','0','2',NPRICE,'1','2','.','3','4','5',MULT,'2',PLU1,'8',DISC+2,TEND+1,//收据43
	'1','2','3','.','0','3',NPRICE,'1','2','.','3','4','5',MULT,'3',PLU1,'8',DISC+2,TEND+1,//收据44
	//0,// 打印Z报表 28//

	// 每个收据三笔,-8% //
	'1','2','3','.','0','1',NPRICE,'1','2','.','3','4','5',MULT,'1',PLU1,'8',DISC_PERDEC,
	'1','2','3','.','0','2',NPRICE,'1','2','.','3','4','5',MULT,'2',PLU1,'8',DISC_PERDEC,
	'1','2','3','.','0','3',NPRICE,'1','2','.','3','4','5',MULT,'3',PLU1,'8',DISC+2,TEND+1,//收据45
	//0,// 打印Z报表 29//

	// 每个收据三笔,小计折扣-8% //
	'1','2','3','.','0','1',NPRICE,'1','2','.','3','4','5',MULT,'1',PLU1,
	'1','2','3','.','0','2',NPRICE,'1','2','.','3','4','5',MULT,'2',PLU1,
	'1','2','3','.','0','3',NPRICE,'1','2','.','3','4','5',MULT,'3',PLU1,SUB,'8',DISC+2,TEND+1,//收据46
	//0,// 打印Z报表 30//
//--------------------------------------------------------------------------

	// 每个收据三笔,-8% //
	'1','2','3','.','0','1',NPRICE,'1','2','.','3','4','5',MULT,'1',PLU1,'8',DISC_PERDEC,
	'1','2','3','.','0','2',NPRICE,'1','2','.','3','4','5',MULT,'2',PLU1,
	'1','2','3','.','0','3',NPRICE,'1','2','.','3','4','5',MULT,'3',PLU1,'8',DISC+2,TEND+1,//收据47
	//0,// 打印Z报表 31//
//--------------------------------------------------------------------------


// 3. 单品+部类销售>>>>>>>>>>>>>>>>>>>
	// 每个收据一笔 //
	'1','2','3','.','0','1',NPRICE,'1',PLU1,TEND+1,//收据48
	'1','2','3','.','0','2',DEPT+2,	TEND+1,//收据49
	'1','2','3','.','0','3',DEPT+3,	TEND+1,//收据50
	//0,// 打印Z报表 32//

	// 每个收据三笔 //
	'1','2','3','.','0','1',DEPT+1,
	'1','2','3','.','0','2',NPRICE,'2',PLU1,
	'1','2','3','.','0','3',DEPT+3,	TEND+1,//收据51
	//0,// 打印Z报表 33//
//--------------------------------------------------------------------------

	// 每个收据一笔,-8% //
	'1','2','3','.','0','1',DEPT+1,'8',DISC_PERDEC,	TEND+1,//收据52
	'1','2','3','.','0','2',DEPT+2,'8',DISC_PERDEC,	TEND+1,//收据53
	'1','2','3','.','0','3',NPRICE,'3',PLU1,'8',DISC_PERDEC,	TEND+1,//收据54
	//0,// 打印Z报表 34//

	// 每个收据三笔,-8% //
	'1','2','3','.','0','1',NPRICE,'1',PLU1,'8',DISC_PERDEC,
	'1','2','3','.','0','2',DEPT+2,'8',DISC_PERDEC,
	'1','2','3','.','0','3',DEPT+3,'8',DISC_PERDEC,	TEND+1,//收据55
	//0,// 打印Z报表 35//

	// 每个收据三笔,小计折扣-8% //
	'1','2','3','.','0','1',DEPT+1,
	'1','2','3','.','0','2',NPRICE,'2',PLU1,
	'1','2','3','.','0','3',DEPT+3,SUB,'8',DISC_PERDEC,	TEND+1,//收据56
	//0,// 打印Z报表 36//
//--------------------------------------------------------------------------

	// 每个收据三笔,-8% //
	'1','2','3','.','0','1',NPRICE,'1',PLU1,'8',DISC_PERDEC,
	'1','2','3','.','0','2',DEPT+2,
	'1','2','3','.','0','3',DEPT+3,'8',DISC_PERDEC,	TEND+1,//收据57
	//0,// 打印Z报表 37//
//--------------------------------------------------------------------------

	// 每个收据一笔,销售数量12.345 //

	'1','2','3','.','0','1',NPRICE,'1','2','.','3','4','5',MULT,'1',PLU1,TEND+1,//收据55
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,	TEND+1,//收据59
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,	TEND+1,//收据60
	//0,// 打印Z报表 38//

	// 每个收据三笔 //
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
	'1','2','3','.','0','2',NPRICE,'1','2','.','3','4','5',MULT,'2',PLU1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,	TEND+1,//收据61
	//0,// 打印Z报表 39///

//--------------------------------------------------------------------------
	// 每个收据一笔,-8% //
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,'8',DISC_PERDEC,	TEND+1,//收据62
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,'8',DISC_PERDEC,	TEND+1,//收据63
	'1','2','3','.','0','3',NPRICE,'1','2','.','3','4','5',MULT,'3',PLU1,'8',DISC+2,TEND+1,//收据64
	//0,// 打印Z报表 40//


	// 每个收据三笔,-8% //
	'1','2','3','.','0','1',NPRICE,'1','2','.','3','4','5',MULT,'1',PLU1,'8',DISC_PERDEC,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,'8',DISC_PERDEC,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,'8',DISC+2,TEND+1,//收据65
	//0,// 打印Z报表 41//

	// 每个收据三笔,小计折扣-8% //
	'1','2','3','.','0','1',NPRICE,'1','2','.','3','4','5',MULT,'1',PLU1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,SUB,'8',DISC_PERDEC,	TEND+1,//收据66
	//0,// 打印Z报表 42//
//--------------------------------------------------------------------------
	// 每个收据三笔,-8% //
	'1','2','3','.','0','1',NPRICE,'1','2','.','3','4','5',MULT,'1',PLU1,'8',DISC_PERDEC,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,'8',DISC_PERDEC,	TEND+1,//收据67
	//0,// 打印Z报表 43//
//--------------------------------------------------------------------------


// 4. 取消交易>>>>>>>>>>>>>>>>>>>
	'1','2','3','.','0','1',DEPT+1,
	'1','2','3','.','0','2',NPRICE,'2',PLU1,
	'1','2','3','.','0','1',NPRICE,'1','2','.','3','4','5',MULT,'1',PLU1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,'8',DISC_PERDEC,
	'1','2','3','.','0','2',DEPT+2,'8',DISC_PERDEC,
	'1','2','3','.','0','3',DEPT+3,'8',DISC_PERDEC,	xRECEIPT,ENTER,//收据68
	// 每个收据三笔,小计折扣-8% //
	'1','2','3','.','0','1',DEPT+1,
	'1','2','3','.','0','2',NPRICE,'2',PLU1,
	'1','2','3','.','0','3',DEPT+3,SUB,'8',DISC_PERDEC,	xRECEIPT,ENTER,//收据69
	//0,// 打印Z报表 44//
//-----------------------------------------------------------------------------------
/* 以上销售数据两次(138张收据)的Z报表:
         DAILY REPORT-Z
================================
      GRAND TOTAL
................................
TOTAL TRADE                  135
QUANTITY                  1619.4
AMOUNT                199,218.76
DISCOUNT              -10,188.62
NET AMOUNT            189,030.14
--------------------------------
      DEPARTMENT
DEPARTMENT   QUANTITY     AMOUNT
................................
DEPT1          539.8   66,400.86
                DISCOUN-3,658.60
DEPT2          539.8   66,406.12
                DISCOUN-2,870.88
DEPT3          539.8   66,411.78
                DISCOUN-3,659.14
--------------------------------
      TENDER
................................
#00001   CASH
TOTAL TRADE                  134
AMOUNT                189,030.08
--------------------------------
      DRAWER
................................
#00001   CASH
AMOUNT                189,030.08
--------------------------------
      CORRECTION
................................
#00002   VOID
QUANTITY                      -4
AMOUNT                   -492.06
#00004   CANCEL
QUANTITY                       4
AMOUNT                 -7,455.16
--------------------------------
      DISCOUNT
................................
#00002 -%
QUANTITY                      96
AMOUNT                 -6,303.84
#00004 -NET
QUANTITY                      18
AMOUNT                   -903.42
#00006 SUBTOTAL-%
QUANTITY                      12
AMOUNT                 -2,364.00
#00008 SUBTOTAL-
QUANTITY                       6
AMOUNT                   -617.42
--------------------------------
*/
//>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> 餐饮方式下销售测试 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
// 1. 部类销售>>>>>>>>>>>>>>>>>>>

#if (0)//=0,不测试餐饮功能

	// 每个收据一笔 //
	'1',PBF+1,
	'1','2','3','.','0','1',DEPT+1,
	'1','2','3','.','0','2',DEPT+2,
	'1','2','3','.','0','3',DEPT+3,
	PBF+4,TEND+1,// 直接结账 //
	0,// 打印Z报表 45//

	// 每个收据三笔 //
	'1',PBF+1,
	'1','2','3','.','0','1',DEPT+1,
	PBF+1,'1',PBF+1,	// 添加销售 //
	'1','2','3','.','0','2',DEPT+2,
	'1','2','3','.','0','3',DEPT+3,
	PBF+1,'1',PBF+5,PBF+4,TEND+1,// 打印开台后结账 //
	0,// 打印Z报表 46//

	// 每个收据三笔 //
	'1',PBF+1,
	'1','2','3','.','0','1',DEPT+1,
	'1','2','3','.','0','2',DEPT+2,
	'1','2','3','.','0','3',DEPT+3,
	PBF+1,'1',PBF+1,
	xBEFOR,'1','2','3','.','0','1',DEPT+1,// 修改销售 //
	xBEFOR,'1','2','3','.','0','2',DEPT+2,
	'1','2','3','.','0','1',DEPT+1,// 添加销售 //
	'1','2','3','.','0','2',DEPT+2,
	PBF+1,'1',PBF+5,PBF+4,TEND+1,// 打印开台后结账 //
	0,// 打印Z报表 47//
//---------------------------------------------------------------------

	// 每个收据一笔,-8% //
	'1',PBF+1,
	'1','2','3','.','0','1',DEPT+1,'8',DISC_PERDEC,
	'1','2','3','.','0','2',DEPT+2,'8',DISC_PERDEC,
	'1','2','3','.','0','3',DEPT+3,'8',DISC_PERDEC,
	PBF+4,TEND+1,// 直接结账 //
	0,// 打印Z报表 48//

	// 每个收据三笔,-8% //
	'1',PBF+1,
	'1','2','3','.','0','1',DEPT+1,'8',DISC_PERDEC,
	PBF+1,	'1',PBF+1,
	'1','2','3','.','0','2',DEPT+2,'8',DISC_PERDEC,
	'1','2','3','.','0','3',DEPT+3,	'8',DISC_PERDEC,
	PBF+1,	'1',PBF+5,PBF+4,TEND+1,// 打印开台后结账 //
	0,// 打印Z报表 49//
//#endif

	// 每个收据三笔,小计折扣-8% //???????????????????????????
	'1',PBF+1,
	'1','2','3','.','0','1',DEPT+1,
	PBF+1,	'1',PBF+1,
	'1','2','3','.','0','2',DEPT+2,
	'1','2','3','.','0','3',DEPT+3,SUB,	'8',DISC_PERDEC,
	PBF+1,	'1',PBF+5,PBF+4,TEND+1,// 打印开台后结账 //
	0,// 打印Z报表 50//


	// 每个收据三笔,直接折扣 //
	'1',PBF+1,
	'1','2','3','.','0','1',DEPT+1,'2','9','.','8','4',DISC_NETDEC,
	'1','2','3','.','0','2',DEPT+2,'2','9','.','8','4',DISC_NETDEC,
	'1','2','3','.','0','3',DEPT+3,'2','9','.','8','4',DISC_NETDEC,
	PBF+4,TEND+1,// 直接结账 //
	0,// 打印Z报表 51//

	// 每个收据三笔,小计直接折扣 //
	'1',PBF+1,
	'1','2','3','.','0','1',DEPT+1,
	PBF+1,	'1',PBF+1,
	'1','2','3','.','0','2',DEPT+2,
	'1','2','3','.','0','3',DEPT+3,SUB,	'1','8','9','.','5','2',DISC_NETDEC,
	PBF+1,	'1',PBF+5,PBF+4,TEND+1,// 打印开台后结账 //
	0,// 打印Z报表 52//
//--------------------------------------------------------------------------
	// 每个收据三笔,-8% //
	'1',PBF+1,
	'1','2','3','.','0','1',DEPT+1,'8',DISC_PERDEC,
	PBF+1,	'1',PBF+1,
	'1','2','3','.','0','2',DEPT+2,
	'1','2','3','.','0','3',DEPT+3,'8',DISC_PERDEC,
	PBF+1,	'1',PBF+5,PBF+4,TEND+1,// 打印开台后结账 //
	0,// 打印Z报表 53//
//--------------------------------------------------------------------------
	// 每个收据一笔,销售数量12.345 //
	'1',PBF+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,
	PBF+4,TEND+1,// 直接结账 //
	0,// 打印Z报表 54//

	// 每个收据三笔 //
	'1',PBF+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
	PBF+1,	'1',PBF+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,
	PBF+1,	'1',PBF+5,PBF+4,TEND+1,// 打印开台后结账 //
	0,// 打印Z报表 55//
//--------------------------------------------------------------------------
	// 每个收据一笔,-8% //
	'1',PBF+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,'8',DISC_PERDEC,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,'8',DISC_PERDEC,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,'8',DISC_PERDEC,
	PBF+4,TEND+1,// 直接结账 //
	0,// 打印Z报表 56//

	// 每个收据三笔,-8% //
	'1',PBF+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,'8',DISC_PERDEC,
	PBF+1,	'1',PBF+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,'8',DISC_PERDEC,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,'8',DISC_PERDEC,
	PBF+1,	'1',PBF+5,PBF+4,TEND+1,// 打印开台后结账 //
	0,// 打印Z报表 57//

	// 每个收据三笔,小计折扣-8% //
	'1',PBF+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
	PBF+1,	'1',PBF+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,SUB,'8',DISC_PERDEC,
	PBF+1,	'1',PBF+5,PBF+4,TEND+1,// 打印开台后结账 //
	0,// 打印Z报表 58//

	// 每个收据三笔,直接折扣 //
	'1',PBF+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,'9','9','.','8','8',DISC_NETDEC,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,'9','9','.','8','9',DISC_NETDEC,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,'9','9','.','9','0',DISC_NETDEC,
	PBF+4,TEND+1,// 直接结账 //
	0,// 打印Z报表 59//

	// 每个收据三笔,小计直接折扣 //
	'1',PBF+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
	PBF+1,	'1',PBF+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,SUB,'2','9','.','6','7',DISC_NETDEC,
	PBF+1,	'1',PBF+5,PBF+4,TEND+1,// 打印开台后结账 //
	0,// 打印Z报表 60//

//--------------------------------------------------------------------------
	// 每个收据三笔,-8% //
	'1',PBF+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,'8',DISC_PERDEC,
	PBF+1,	'1',PBF+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,'8',DISC_PERDEC,
	PBF+1,	'1',PBF+5,PBF+4,TEND+1,// 打印开台后结账 //
	0,// 打印Z报表 61//
//--------------------------------------------------------------------------

// 2. 单品销售>>>>>>>>>>>>>>>>>>>
	// 每个收据一笔 //
	'1',PBF+1,
	'1','2','3','.','0','1',NPRICE,'1',PLU1,
	'1','2','3','.','0','2',NPRICE,'2',PLU1,
	'1','2','3','.','0','3',NPRICE,'3',PLU1,
	PBF+4,TEND+1,// 直接结账 //
	0,// 打印Z报表 62//

	// 每个收据三笔 //
	'1',PBF+1,
	'1','2','3','.','0','1',NPRICE,'1',PLU1,
	PBF+1,	'1',PBF+1,
	'1','2','3','.','0','2',NPRICE,'2',PLU1,
	'1','2','3','.','0','3',NPRICE,'3',PLU1,
	PBF+1,	'1',PBF+5,PBF+4,TEND+1,// 打印开台后结账 //
	0,// 打印Z报表 63//
//--------------------------------------------------------------------------

	// 每个收据一笔,-8% //
	'1',PBF+1,
	'1','2','3','.','0','1',NPRICE,'1',PLU1,'8',DISC_PERDEC,
	'1','2','3','.','0','2',NPRICE,'2',PLU1,'8',DISC_PERDEC,
	'1','2','3','.','0','3',NPRICE,'3',PLU1,'8',DISC_PERDEC,
	PBF+4,TEND+1,// 直接结账 //
	0,// 打印Z报表 64//


	// 每个收据三笔,-8% //
	'1',PBF+1,
	'1','2','3','.','0','1',NPRICE,'1',PLU1,'8',DISC_PERDEC,
	PBF+1,	'1',PBF+1,
	'1','2','3','.','0','2',NPRICE,'2',PLU1,'8',DISC_PERDEC,
	'1','2','3','.','0','3',NPRICE,'3',PLU1,'8',DISC_PERDEC,
	PBF+1,	'1',PBF+5,PBF+4,TEND+1,// 打印开台后结账 //
	0,// 打印Z报表 65//

	// 每个收据三笔,小计折扣-8% //
	'1',PBF+1,
	'1','2','3','.','0','1',NPRICE,'1',PLU1,
	PBF+1,	'1',PBF+1,
	'1','2','3','.','0','2',NPRICE,'2',PLU1,
	'1','2','3','.','0','3',NPRICE,'3',PLU1,SUB,'8',DISC_PERDEC,
	PBF+1,	'1',PBF+5,PBF+4,TEND+1,// 打印开台后结账 //
	0,// 打印Z报表 66//

	// 每个收据三笔,直接折扣 //
	'1',PBF+1,
	'1','2','3','.','0','1',NPRICE,'1',PLU1,'2','9','.','8','4',DISC_NETDEC,
	'1','2','3','.','0','2',NPRICE,'2',PLU1,'2','9','.','8','4',DISC_NETDEC,
	'1','2','3','.','0','3',NPRICE,'3',PLU1,'2','9','.','8','4',DISC_NETDEC,
	PBF+4,TEND+1,// 直接结账 //
	0,// 打印Z报表 67//

	// 每个收据三笔,小计直接折扣 //
	'1',PBF+1,
	'1','2','3','.','0','1',NPRICE,'1',PLU1,
	PBF+1,	'1',PBF+1,
	'1','2','3','.','0','2',NPRICE,'2',PLU1,
	'1','2','3','.','0','3',NPRICE,'3',PLU1,SUB,'8','9','.','5','2',DISC_NETDEC,
	PBF+1,	'1',PBF+5,PBF+4,TEND+1,// 打印开台后结账 //
	0,// 打印Z报表 68//
//--------------------------------------------------------------------------

	// 每个收据三笔,-8% //
	'1',PBF+1,
	'1','2','3','.','0','1',NPRICE,'1',PLU1,'8',DISC_PERDEC,
	PBF+1,	'1',PBF+1,
	'1','2','3','.','0','2',NPRICE,'2',PLU1,
	'1','2','3','.','0','3',NPRICE,'3',PLU1,'8',DISC_PERDEC,
	PBF+1,	'1',PBF+5,PBF+4,TEND+1,// 打印开台后结账 //
	0,// 打印Z报表 69//

//--------------------------------------------------------------------------

	// 每个收据一笔,销售数量12.345 //
	'1',PBF+1,
	'1','2','3','.','0','1',NPRICE,'1','2','.','3','4','5',MULT,'1',PLU1,
	'1','2','3','.','0','2',NPRICE,'1','2','.','3','4','5',MULT,'2',PLU1,
	'1','2','3','.','0','3',NPRICE,'1','2','.','3','4','5',MULT,'3',PLU1,
	PBF+4,TEND+1,// 直接结账 //
	0,// 打印Z报表 70//

	// 每个收据三笔 //
	'1',PBF+1,
	'1','2','3','.','0','1',NPRICE,'1','2','.','3','4','5',MULT,'1',PLU1,
	PBF+1,	'1',PBF+1,
	'1','2','3','.','0','2',NPRICE,'1','2','.','3','4','5',MULT,'2',PLU1,
	'1','2','3','.','0','3',NPRICE,'1','2','.','3','4','5',MULT,'3',PLU1,
	PBF+1,	'1',PBF+5,PBF+4,TEND+1,// 打印开台后结账 //
	0,// 打印Z报表 71//
//--------------------------------------------------------------------------

	// 每个收据一笔,-8% //
	'1',PBF+1,
	'1','2','3','.','0','1',NPRICE,'1','2','.','3','4','5',MULT,'1',PLU1,'8',DISC_PERDEC,
	'1','2','3','.','0','2',NPRICE,'1','2','.','3','4','5',MULT,'2',PLU1,'8',DISC_PERDEC,
	'1','2','3','.','0','3',NPRICE,'1','2','.','3','4','5',MULT,'3',PLU1,'8',DISC_PERDEC,
	PBF+4,TEND+1,// 直接结账 //
	0,// 打印Z报表 72//

	// 每个收据三笔,-8% //
	'1',PBF+1,
	'1','2','3','.','0','1',NPRICE,'1','2','.','3','4','5',MULT,'1',PLU1,'8',DISC_PERDEC,
	PBF+1,	'1',PBF+1,
	'1','2','3','.','0','2',NPRICE,'1','2','.','3','4','5',MULT,'2',PLU1,'8',DISC_PERDEC,
	'1','2','3','.','0','3',NPRICE,'1','2','.','3','4','5',MULT,'3',PLU1,'8',DISC_PERDEC,
	PBF+1,	'1',PBF+5,PBF+4,TEND+1,// 打印开台后结账 //
	0,// 打印Z报表 73//

	// 每个收据三笔,小计折扣-8% //
	'1',PBF+1,
	'1','2','3','.','0','1',NPRICE,'1','2','.','3','4','5',MULT,'1',PLU1,
	'1','2','3','.','0','2',NPRICE,'1','2','.','3','4','5',MULT,'2',PLU1,
	PBF+1,	'1',PBF+1,
	'1','2','3','.','0','3',NPRICE,'1','2','.','3','4','5',MULT,'3',PLU1,SUB,'8',DISC_PERDEC,
	PBF+1,	'1',PBF+5,PBF+4,TEND+1,// 打印开台后结账 //
	0,// 打印Z报表 74//
//--------------------------------------------------------------------------

	// 每个收据三笔,-8% //
	'1',PBF+1,
	'1','2','3','.','0','1',NPRICE,'1','2','.','3','4','5',MULT,'1',PLU1,'8',DISC_PERDEC,
	'1','2','3','.','0','2',NPRICE,'1','2','.','3','4','5',MULT,'2',PLU1,
	PBF+1,	'1',PBF+1,
	'1','2','3','.','0','3',NPRICE,'1','2','.','3','4','5',MULT,'3',PLU1,'8',DISC_PERDEC,
	PBF+1,	'1',PBF+5,PBF+4,TEND+1,// 打印开台后结账 //
	0,// 打印Z报表 75//
//--------------------------------------------------------------------------


// 3. 单品+部类销售>>>>>>>>>>>>>>>>>>>
	// 每个收据一笔 //
	'1',PBF+1,
	'1','2','3','.','0','1',NPRICE,'1',PLU1,
	'1','2','3','.','0','2',DEPT+2,
	'1','2','3','.','0','3',DEPT+3,
	PBF+4,TEND+1,// 直接结账 //
	0,// 打印Z报表 76//

	// 每个收据三笔 //
	'1',PBF+1,
	'1','2','3','.','0','1',DEPT+1,
	'1','2','3','.','0','2',NPRICE,'2',PLU1,
	PBF+1,	'1',PBF+1,
	'1','2','3','.','0','3',DEPT+3,
	PBF+1,	'1',PBF+5,PBF+4,TEND+1,// 打印开台后结账 //
	0,// 打印Z报表 77//
//--------------------------------------------------------------------------

	// 每个收据一笔,-8% //
	'1',PBF+1,
	'1','2','3','.','0','1',DEPT+1,'8',DISC_PERDEC,
	'1','2','3','.','0','2',DEPT+2,'8',DISC_PERDEC,
	'1','2','3','.','0','3',NPRICE,'3',PLU1,'8',DISC_PERDEC,
	PBF+4,TEND+1,// 直接结账 //
	0,// 打印Z报表 78//

	// 每个收据三笔,-8% //
	'1',PBF+1,
	'1','2','3','.','0','1',NPRICE,'1',PLU1,'8',DISC_PERDEC,
	'1','2','3','.','0','2',DEPT+2,'8',DISC_PERDEC,
	PBF+1,	'1',PBF+1,
	'1','2','3','.','0','3',DEPT+3,'8',DISC_PERDEC,
	PBF+1,	'1',PBF+5,PBF+4,TEND+1,// 打印开台后结账 //
	0,// 打印Z报表 79//

	// 每个收据三笔,小计折扣-8% //
	'1',PBF+1,
	'1','2','3','.','0','1',DEPT+1,
	'1','2','3','.','0','2',NPRICE,'2',PLU1,
	PBF+1,	'1',PBF+1,
	'1','2','3','.','0','3',DEPT+3,SUB,'8',DISC_PERDEC,
	PBF+1,	'1',PBF+5,PBF+4,TEND+1,// 打印开台后结账 //
	0,// 打印Z报表 80//
//--------------------------------------------------------------------------

	// 每个收据三笔,-8% //
	'1',PBF+1,
	'1','2','3','.','0','1',NPRICE,'1',PLU1,'8',DISC_PERDEC,
	'1','2','3','.','0','2',DEPT+2,
	'1','2','3','.','0','3',DEPT+3,'8',DISC_PERDEC,
	PBF+4,TEND+1,// 直接结账 //
	0,// 打印Z报表 81//
//--------------------------------------------------------------------------

	// 每个收据一笔,销售数量12.345 //
 	'1',PBF+1,
	'1','2','3','.','0','1',NPRICE,'1','2','.','3','4','5',MULT,'1',PLU1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,
	PBF+4,TEND+1,// 直接结账 //
	0,// 打印Z报表 82//

	// 每个收据三笔 //
 	'1',PBF+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
	'1','2','3','.','0','2',NPRICE,'1','2','.','3','4','5',MULT,'2',PLU1,
	PBF+1,	'1',PBF+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,
	PBF+1,	'1',PBF+5,PBF+4,TEND+1,// 打印开台后结账 //
	0,// 打印Z报表 83//

//--------------------------------------------------------------------------
	// 每个收据一笔,-8% //
 	'1',PBF+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,'8',DISC_PERDEC,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,'8',DISC_PERDEC,
	'1','2','3','.','0','3',NPRICE,'1','2','.','3','4','5',MULT,'3',PLU1,'8',DISC_PERDEC,
	PBF+4,TEND+1,// 直接结账 //
	0,// 打印Z报表 84//

 	// 每个收据三笔,-8% //
 	'1',PBF+1,
	'1','2','3','.','0','1',NPRICE,'1','2','.','3','4','5',MULT,'1',PLU1,'8',DISC_PERDEC,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,'8',DISC_PERDEC,
	PBF+1,	'1',PBF+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,'8',DISC_PERDEC,
	PBF+1,	'1',PBF+5,PBF+4,TEND+1,// 打印开台后结账 //
	0,// 打印Z报表 85//

	// 每个收据三笔,小计折扣-8% //
 	'1',PBF+1,
	'1','2','3','.','0','1',NPRICE,'1','2','.','3','4','5',MULT,'1',PLU1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,
	PBF+1,	'1',PBF+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,SUB,'8',DISC_PERDEC,
	PBF+1,	'1',PBF+5,PBF+4,TEND+1,// 打印开台后结账 //
	0,// 打印Z报表 86//
//--------------------------------------------------------------------------
	// 每个收据三笔,-8% //
 	'1',PBF+1,
	'1','2','3','.','0','1',NPRICE,'1','2','.','3','4','5',MULT,'1',PLU1,'8',DISC_PERDEC,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,
	PBF+1,	'1',PBF+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,'8',DISC_PERDEC,
	PBF+1,	'1',PBF+5,PBF+4,TEND+1,// 打印开台后结账 //
	0,// 打印Z报表 87//
//--------------------------------------------------------------------------
//ccr091223>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> 超市+餐饮方式下销售测试 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
	// 每个收据一笔,销售数量12.345 //
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,
	TEND+1,// 直接结账 //

	// 每个收据三笔 //
	'1',PBF+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
	PBF+1,	'1',PBF+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,
	PBF+1,	'1',PBF+5,PBF+4,TEND+1,// 打印开台后结账 //
	0,// 打印Z报表 88//

//ccr091223>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> 超市+餐饮方式下销售测试+退货>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

	// 每个收据3笔,销售数量12.345 //
#if (REFUND_RECEIPT)
	xREFUND,
#endif

	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,

#if (REFUND_RECEIPT==0)
	xREFUND,
#endif

	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,

	TEND+1,// 直接结账 //
	0,// 打印Z报表 89//

#if (REFUND_RECEIPT==0)
	// 每个收据3笔,销售数量12.345 //
	'1',PBF+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,

	xREFUND,	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
	PBF+4,TEND+1,// 直接结账 //
	0,// 打印Z报表 90//


	// 每个收据三笔 //
	'1',PBF+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
	PBF+1,	'1',PBF+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,

	xREFUND,	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,

	PBF+1,	'1',PBF+5,PBF+4,TEND+1,// 打印开台后结账 //
	0,// 打印Z报表 91//
#endif
//----------------------------------------------------------------------------
	// 每个收据3笔,销售数量12.345 //
#if (REFUND_RECEIPT)
	xREFUND,
#endif

	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,

#if (REFUND_RECEIPT==0)
	xREFUND,
#endif

	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
	TEND+1,// 直接结账 //

#if (REFUND_RECEIPT==0)

	// 每个收据3笔,销售数量12.345 //
	'1',PBF+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,

	xREFUND,	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
	PBF+4,TEND+1,// 直接结账 //

	// 每个收据三笔 //
	'1',PBF+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
	PBF+1,	'1',PBF+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','2',DEPT+2,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','3',DEPT+3,

	xREFUND,	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
	'1','2','.','3','4','5',MULT,'1','2','3','.','0','1',DEPT+1,
	PBF+1,	'1',PBF+5,PBF+4,TEND+1,// 打印开台后结账 //
#endif

#endif
    TEST_REPEAT1,   // 循环两次(2~5时,指定循环次数
	TEST_ZREPORT,   // 打印Z报表 92//
    TEST_NEXTDAY,    //等待过一天
    TEST_END
#endif

};
//<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
#endif//fastmode

extern WORD BCC;

//---------------------------------------------
//Send a BCD data
//pPoints=Bits after point must been send
//When pPoints=2:
//1234567.896---->123456789 been send
//1234567.8------>123456780 been send
void SendABCD(BCD *pBcd)
{
	BYTE sBcd,sP,sFlag,sCh;//
	int i;


	sP = (pBcd->Sign) & 0x07;
	if (TESTBIT(pBcd->Sign, BIT7) && COMPUTER)
	{
		SendComm(COMPUTER_1,'-');
		//BCC+='-';
	}

	sBcd=0xf0;
	sFlag = 0;
	for (i=BCDLEN-1;i>=0;)
	{
		sCh = pBcd->Value[i];
		if (!sFlag && (sCh & sBcd))
			sFlag = 1;
		if (sFlag)
		{
			if (sBcd == 0xf0)
				sCh = (sCh>>4)+'0';
			else
				sCh = (sCh & 0x0f)+'0';
            if (COMPUTER)	SendComm(COMPUTER_1,sCh);
			//BCC+=sCh;
		}
		sBcd ^= 0xff;
		if (sBcd==0xf0)
			i--;
	}
	if(!sFlag && COMPUTER)
		SendComm(COMPUTER_1, '0');

}
//-----------------------------------------

void SendAWord(WORD pLInt)
{

	char sDisp[30];

	//memset(sDisp,' ',sizeof(sDisp));
	HEXtoASC(sDisp, (char*)&pLInt, 2);
	sDisp[2*2] = 0;
	SendString(sDisp,4);

}
//Send a long int
void SendALong(long pLInt)
{
#if (1)//发送Hex格式数据
	char sDisp[30];

	//memset(sDisp,' ',sizeof(sDisp));
	HEXtoASC(sDisp, (char*)&pLInt, 4);
	sDisp[4*2] = 0;
	SendString(sDisp,8);

#else//发送BCD格式数据

	BCD sBCD;
	sBCD = ZERO;

	if (pLInt<0)
	{
		SETBIT(sBCD.Sign,BIT7);
		pLInt = -pLInt;
	}
	ULongToBCDValue(sBCD.Value, pLInt);
	SendABCD(&sBCD);
#endif
}

// 海量测试程序,通过输入数字+功能键来启动海量测试,所输入的数字作为开票的发票起始号码 //
// 加电初始化时,必须把FisTestTask清为0 //
#if FASTMODE
//快速测试销售
void FisTestProc()
{
    static unsigned long testDelay=0;

	if ((GetSystemTimer()-testDelay)>TESTDELAY && FisTestTask.Going && KeyFrHost==0xff  && FisTestTask.LastDay != Now.day)
	{
        testDelay = GetSystemTimer();
	    if (ApplVar.ErrorNumber==0)
	    {
	        if (FisTestTask.AutoKeyCurrent<FisTestTask.AutoReceiptTag)
	        {
#if (1)
				//快速测试销售
	            KeyFrHost = FisTestTask.AutoKeyBuf[FisTestTask.AutoKeyCurrent++];
                if ((KeyFrHost & 0xf0) == 0xf0)
                {
                    KeyFrHost &= 0x0f;
                    switch (KeyFrHost)
                    {
                    case TEST_END:
                        //SendALong(ApplVar.FlowHeader.NextNP);SendComm(COMPUTER_1,'\n');
                        FisTestTask.Going=(FisTestTask.TestCount!=0);//只测试一次
                        FisTestTask.AutoKeyCurrent = 0;
                        FisTestTask.TestCount++;
                        FisTestTask.Repeat=0;
                        KeyFrHost = 0xff;
                        return;
                    case TEST_ZREPORT:
                        {//打印Z报表
                            KeyFrHost = 0xff;
                            SetLoop();

                            if (FisTestTask.TestCount>0)
                            {//第一次测试时,不自动打印Z报表
                                DispStrXY("Print Z Report....",0,2);
                                ApplVar.FReport = ApplVar.CentralLock = Z;
                                ApplVar.ReportNumber = 1;
                                ApplVar.RepComputer = 0;

                                GetReport(ApplVar.ReportNumber);

                                ApplVar.FReport = 0;
                                ApplVar.CentralLock = RG;
                            }
                            else
                                DispStrXY("Print Z Please....",0,2);

                            ResetLoop();
                            break;
                        }
                    case TEST_NEXTDAY:
                        {//等待过一天
                            KeyFrHost = 0xff;
                            Now.sec = 0x59;
                            Now.min = 0x59;
                            Now.hour = 0x23;
                            FisTestTask.LastDay = Now.day;
                            SetTimeDate(1,&Now);
                            break;
                        }
                    default:
                        if (KeyFrHost>=TEST_REPEAT1 && KeyFrHost<=TEST_REPEAT10)
                        {//循环
                            if (FisTestTask.Repeat==0)
                                FisTestTask.Repeat = KeyFrHost;
                            FisTestTask.Repeat--;
                            if (FisTestTask.Repeat)
                            {
                                FisTestTask.AutoKeyCurrent = 0;
                            }
                            KeyFrHost = 0xff;
                        }
                    }
                }
//				if ((ApplVar.FlowHeader.NextNP & 0x0f)==0x0f)
//				{
//					DisplayHex((char*)&ApplVar.FlowHeader.NextNP,4);
//					SendALong(ApplVar.FlowHeader.NextNP);
//					SendComm(COMPUTER_1,'\n');
//				}

#else
				//测试写日志
				CLONG(FisTestTask.AutoKeyBuf[0])=ApplVar.FlowHeader.NextNP;
				for (FisTestTask.AutoReceiptTag=0;FisTestTask.AutoReceiptTag<26;FisTestTask.AutoReceiptTag++)
				{
					FisTestTask.AutoKeyBuf[FisTestTask.AutoReceiptTag+4]=FisTestTask.AutoReceiptTag+'a';
				}
				FisTestTask.AutoKeyBuf[FisTestTask.AutoReceiptTag+4]='-';
				for (FisTestTask.AutoReceiptTag=0;FisTestTask.AutoReceiptTag<26;FisTestTask.AutoReceiptTag++)
				{
					FisTestTask.AutoKeyBuf[FisTestTask.AutoReceiptTag+26+4+1]=FisTestTask.AutoReceiptTag+'A';
				}

				WriteToLogRam(ApplVar.FlowHeader.NextNP,(char *)&FisTestTask.AutoKeyBuf,52+4+1);
				ApplVar.FlowHeader.NextNP = ApplVar.FlowHeader.NextNP + 52+4+1;
				ADJLOGADDR(ApplVar.FlowHeader.NextNP);

				//if ((ApplVar.FlowHeader.NextNP & 0x07)==7)
				{
					DisplayHex((char*)&ApplVar.FlowHeader.NextNP,4);
					SendALong(ApplVar.FlowHeader.NextNP);
					SendComm(COMPUTER_1,'\n');
				}
				if (ApplVar.FlowHeader.NextNP>0x1fff00L)
				{
					FisTestTask.Going = 0;
				}
#endif
	        }
            else
            {
                FisTestTask.Going=(FisTestTask.TestCount!=0);//只测试一次
                FisTestTask.AutoKeyCurrent = 0;
                FisTestTask.TestCount++;
                FisTestTask.Repeat=0;
            }
	    }
	}
}
#else
//完整测试销售
void FisTestProc()
{
    static unsigned long testDelay=0;

	int i,l,k,n;
	ULONG sAmt;
	WORD ch;


	GetTimeDate(&Now);
//	if (FisTestTask.Going)	{SendALong(PrnTemperature());SendComm(0,'\n');}//testonly
    //以下使用KeyEmuList中的按键进行测试
    if ((GetSystemTimer()-testDelay)>TESTDELAY && FisTestTask.Going && KeyFrHost==0xff && FisTestTask.LastDay != Now.day)
    {
        testDelay = GetSystemTimer();

	    if (ApplVar.ErrorNumber)
    	{//测试出错时,停止测试
#if SENDTOHOST
            if (COMPUTER)
            {
                SendString("Error=",6);SendComm(0,(ApplVar.ErrorNumber & 0x7f)/10 +'0');SendComm(0,(ApplVar.ErrorNumber & 0x7f)%10 +'0');SendComm(0,'\n');
            }
#endif
    		FisTestTask.Going=0;
	        return;
    	}

//		if (FisTestTask.KeyEmuNum<sizeof(KeyEmuList)/2)
		{//从KeyEmuList中取按键

//			if (FisTestTask.KeyEmuNum==0)
//			{//使用餐饮键盘
//				memcpy(&ApplVar.AP.KeyTable,&KeyTablePBF,sizeof(KeyTablePBF));
//				RESETBIT(ApplVar.MyFlags, PRNONPB);//
//			}
            ch = KeyEmuList[FisTestTask.KeyEmuNum++];
			switch (ch)
			{
            case TEST_END:
                FisTestTask.KeyEmuNum = 0;
                FisTestTask.Going=(FisTestTask.TestCount!=0);//首次测试时,自动停止
                FisTestTask.TestCount++;
                FisTestTask.Repeat = 0;
                return;
            case TEST_ZREPORT://打印Z报表
                SetLoop();

                if (FisTestTask.TestCount>0)
                {//第一次测试时,不自动打印Z报表
                    DispStrXY("Print Z Report....",0,2);
                    ApplVar.FReport = ApplVar.CentralLock = Z;
                    ApplVar.ReportNumber = 1;
                    ApplVar.RepComputer = 0;

                    GetReport(ApplVar.ReportNumber);

                    ApplVar.FReport = 0;
                    ApplVar.CentralLock = RG;
                }
                else
                    DispStrXY("Print Z Please....",0,2);

                ResetLoop();
                break;
            case TEST_NEXTDAY:
    			{//等待过一天
                    Now.sec = 0x59;
                    Now.min = 0x59;
                    Now.hour = 0x23;
                    FisTestTask.LastDay = Now.day;
                    SetTimeDate(1,&Now);
                    break;
    			}
            default:
                if (ch>=TEST_REPEAT1 && ch<=TEST_REPEAT10)
                {//循环
                    if (FisTestTask.Repeat==0)
                        FisTestTask.Repeat = ch;
                    FisTestTask.Repeat--;
                    if (FisTestTask.Repeat)
                    {
                        FisTestTask.KeyEmuNum = 0;
                    }
                }
    			else
                {
    			    for (i=0;i<MAXKEYB;i++)
                    {//根据功能码生成键盘位置码
                        if (ch==ApplVar.AP.KeyTable[i])
                        {
                            KeyFrHost = i;
                            break;
                        }
                    }
                    if (i>=MAXKEYB)
                    {
                        DisplayDecXY(ch,0,2,5); DispStrXY("--Not found",6,2);
                        FisTestTask.Going=(FisTestTask.TestCount!=0);//首次测试时,自动停止
                    }
#if (SENDTOHOST && (defined(CASE_EJSD) || defined(CASE_EJFLASH)))
                    else if (KeyFrHost==TEND+1)
                    {
                        SendALong(ApplVar.EJHeader.AddrNextEJ);
                    }
#endif
                }
            }
		}
	}
}

#endif
//将AutoKeyEmuList中的功能码转换为对应的按键存入AutoKeyBuf中
void chkAutoReceiptKey()
{
#if FASTMODE
    int i,j,k;

      k=0;
      for (j=0;(AutoKeyEmuList[j]!=TEST_END) && (k<AUTOBUFMAX);j++)
      {
          if (AutoKeyEmuList[j]<16)
          {
              FisTestTask.AutoKeyBuf[k++]=AutoKeyEmuList[j] | 0xf0;
          }
          else
          {
              for (i=0;i<64;i++)
                  if (ApplVar.AP.KeyTable[i]==AutoKeyEmuList[j])
                      FisTestTask.AutoKeyBuf[k++]=i;
          }
      }
      FisTestTask.AutoKeyCurrent = 0;
      FisTestTask.AutoReceiptTag = k;
#endif
}

